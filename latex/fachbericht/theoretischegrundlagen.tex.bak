\section{Theoretische Grundlagen}
Eine Regelung besteht, wie in Abbildung \ref{regelstrecke} zu sehen ist, aus einem Regler und einer Regelstrecke. Beispiele einer Regelung sind Raumheizungen, Lötkolben oder Geschwindigkeitsregelungen.\newline 

\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{Regelstrecke.png}
\caption{Regelung bestehend aus Regler und Regelstrecke \cite{rnwissen}}
\label{regelstrecke}
\end{figure}
%Quelle: http://rn-wissen.de/wiki/index.php/Datei:Regelkreis4.png [Abrufdatum 6.5.15]


Ist eine Regelstrecke gegeben, im Falle eines Lötkolbens wäre dies die Distanz vom Heizelement bis zur Lötspitze, so muss ein dazu passender Regler dimensioniert werden. Reglerdimensionierungen können über das Auswerten der Schrittantwort der Regelstrecke durchgeführt werden. Um die Schrittantwort zu erhalten wird das Verhalten der Strecke aufgrund eines Schrittes der Eingangsgrösse gemessen. Für die Berechnungen werden die aus der Schrittantwort der Strecke ausgelesenen Kenngrössen Verzugszeit ($T_u$), Anstiegszeit ($T_g$) und Streckenbeiwert ($K_s$) verwendet. Zur Dimensionierung eines passenden Reglers existieren verschiedenste Methoden. Im Folgenden werden nun zwei Möglichkeiten genauer erläutert, wobei das Hauptaugenmerk auf der ersten Methode, der Phasengangmethode, liegt und die zweite, die Dimensionierung mittels gängigen Faustformeln, lediglich zum Vergleich durchgeführt wird.\newline

\newpage
Die Kurve in Abbildung \ref{schrittantwort} stellt die Schrittantwort einer Regelstrecke dar. Daran angelegt ist die Wendetangente, die benötigt wird, um die Verzugs- und die Anstiegszeit messen zu können.\newline

\begin{figure}[h]
\centering
\includegraphics[width=0.6\textwidth]{Schrittantwort.png}
\caption{Schrittantwort einer Regelstrecke \cite{solenicki}}
\label{schrittantwort}
\end{figure}
%Quelle: Skript Mathematisches Labor mlab Bürgi Solenicki

Ziel ist es, PI- sowie PID-Regler zu dimensionieren, das heisst deren Kennwerte zu berechnen. Der PI-Regler hat die Kennwerte Nachstellzeit ($T_n$) und Reglerverstärkung ($K_R$), beim PID-Regler kommt noch die Vorhaltezeit ($T_v$) hinzu.


\subsection{Streckenanalyse}
Aus den gegebenen Kennwerten der Schrittantwort soll nun die Übertragungsfunktion der Strecke berechnet werden, das heisst die Strecke muss identifiziert werden. Die Streckenidentifikation, wird mittels der Sani-Methode durchgeführt. Aus dem Verhältnis von $T_u$ und $T_g$ werden die Ordnung der Strecke ($n$) und die dazugehörigen Zeitkonstanten ($T_1, T_2,..., T_n$) berechnet, die benötigt werden, um die Übertragungsfunktion der Regelstrecke darzustellen. Die Übertragungsfunktion der Strecke ist gemäss Formel \ref{ufunkstr} definiert: \cite{solenicki} \newline
% Quelle Skript "Mathematisches Labor mlab", Soenicki/Bürgi

\begin{align}
G_S(s)=\frac{K_S}{(1+sT_1)(1+sT_2)...(1+sT_n)}
\label{ufunkstr}
\end{align}

\newpage
\subsection{Phasengangmethode}
Bei der Phasengangmethode handelt es sich eigentlich um eine grafische Dimensionierungsmethode, welche früher noch von Hand mit logarithmischem Papier durchgeführt wurde. Anstelle der grafischen Dimensionierung wird die Methode in diesem Fall komplett rechnerisch gelöst. Um die Methode zu verstehen wird ein theoretisches Grundwissen benötigt, welches in folgenden Unterkapiteln erklärt wird.


\subsubsection{Grundlagen}\label{phasenganggrundlagen}
Durch Ersetzen von $s$ durch $j\omega$ in der Übertragungsfunktion der Strecke erhält man den Frequenzgang. Damit die Phasengangmethode angewendet werden kann, wird der Amplituden- sowie der Phasengang der Strecke benötigt (Formeln \ref{agangform}, \ref{phagangform1} und \ref{phagangform2}).


\begin{align}
A_S(\omega)=abs(G_S(j\omega))
\label{agangform}
\end{align}
\begin{align}
\varphi_S(\omega)=arg(G_S(j\omega))
\label{phagangform1}
\end{align}
\begin{align}
\varphi_S(\omega)=-arctan(\omega T_1)-arctan(\omega T_2)...-arctan(\omega T_n)
\label{phagangform2}
\end{align}\newline

Die Zeitkonstanten des zu dimensionierenden Reglers stehen in direktem Zusammenhang mit dessen Amplitudengang. In den Abbildungen \ref{agangpi} und \ref{agangpid} sind die Amplitudengänge eines PI- und eines PID-Reglers dargestellt, wobei die x-Achsen logarithmisch skaliert sind. Wie die Kreisfrequenzen an den Knickstellen mit den Reglerparametern zusammenhängen sollen, ist in Tabelle \ref{amplitudengaenge} ersichtlich.\newline

\begin{figure}[h]
\centering
\includegraphics[width=0.5\textwidth]{agangpi.png}
\caption{Amplitudengang PI-Regler Amp($\omega$) (log. Darstellung) \cite{zellwegerpha}}
\label{agangpi}
\end{figure}
%Quelle: Zellwegerskript

\begin{figure}[h]
\centering
\includegraphics[width=0.6\textwidth]{agangpid.png}
\caption{Amplitudengang PID-Regler Amp($\omega$) (log. Darstellung) \cite{zellwegerpha}}
\label{agangpid}
\end{figure}
%Quelle: Zellwegerskript

\begin{table}[h]
\centering
\renewcommand*{\arraystretch}{1.7}
\begin{tabular}{|l|l|c|}
\hline 
\textbf{PI-Regler} & \multicolumn{2}{c|}{\textbf{PID-Regler}} \\ 
\hline 
$\omega_{PI}=\frac{1}{T_n}$ & $\omega_{nk}=\frac{1}{T_{nk}}=\beta*\omega_{PID}$ & $\omega_{vk}=\frac{1}{T_{vk}}=\frac{\omega_{PID}}{\beta}$ \\ 
\hline 
\end{tabular}
\caption[Amplitudengänge / Knickkreisfrequenzen]{Amplitudengänge Regler und Zusammenhänge mit Knickkreisfrequenzen}
\label{amplitudengaenge}
\renewcommand*{\arraystretch}{1} 
\end{table}

\newpage
Diese Knickkreisfrequenzen ($\omega_{PI}$ in Abb. \ref{agangpi} und $\omega_{PID}$ ind Abb. \ref{agangpid}) werden mithilfe des Phasengangs der Strecke berechnet. Je nachdem welcher Reglertyp dimensioniert werden soll, müssen andere Punkte im Phasengang gesucht werden (Tabelle \ref{phgangpunkte}).\newline

\begin{table}[h]
\centering
\renewcommand*{\arraystretch}{1.7}
\begin{tabular}{|l|c|c|}
\hline 
\textbf{Regler} & \textbf{Phasengang der Strecke $\varphi_s$} & \textbf{Knickkreisfrequenz}  \\ 
\hline 
\textbf{PI} & $-\frac{\pi}{2}=-90^\circ$ & $\omega_{PI}=\frac{1}{T_n}$ \\ 
\hline 
\textbf{PID} & $-\frac{3\pi}{4}=-135^\circ$ & $\omega_{PID}=\frac{1}{\sqrt{T_{nk}T_{vk}}}$ \\ 
\hline 
\end{tabular}
\caption[Wichtige Phasengangpunkte]{Gesuchte Punkte im Phasengang je nach Regler}
\label{phgangpunkte}
\renewcommand*{\arraystretch}{1} 
\end{table}

\newpage
Der PI-Regler kann anhand dieser Dimensionierungskriterien bereits dimensioniert werden. Beim PID-Regler muss allerdings noch ein Parameter mehr bestimmt werden. Es handelt sich um den Faktor $\beta$ welcher benötigt wird um die Knickkreisfrequenzen des PID-Reglers berechnen zu können. Dieser Faktor $\beta$ hängt mit der Tangentensteigung des Phasengangs der offenen Regelung im Punkt $-135^\circ$ zusammen.\newline
Ein Dimensionierungskriterium der Phasengangmethode lautet, dass die Steigung des Phasengangs der gesamten, offenen Regelung bei der Knickkreisfrequenz $\frac{-0.5}{\omega_{PID}}$ betragen soll. Dies hat damit zu tun, dass eine Steigung von -20dB/Dekade angestrebt wird. Die genaue Herleitung von $\beta$ befindet sich im Anhang. Es gilt die folgende Beziehung:\newline

\begin{align}
\frac{2\beta}{1+\beta^2} + \omega_{PID}\frac{d\varphi_{Strecke(\omega_{PID})}}{d\omega} = -0.5
\end{align}\newline

Da der Phasengang der Strecke und somit dessen Ableitung gegeben ist, kann durch Auflösen nach $\beta$ nun auch dieser Parameter ermittelt werden. Ergibt sich ein Wert grösser als eins oder imaginär, so wird $\beta$ als eins angenommen.

Die Verstärkung des Reglers wird mit Hilfe des Phasenrands bestimmt. Der Phasenrand ist die Differenz der Streckenphase zu $-180^\circ$. Bei unterschiedlichem Phasenrand ergeben sich unterschiedliche Verstärkungsfaktoren, was auch auf das Überschwingen des Reglers Einfluss hat. Tabelle \ref{phasenrand} zeigt den Zusammenhang zwischen dem gewählten Phasenrand und dem daraus resultierenden Überschwingen der Regelung.\newline


\begin{table}[h]
\centering
\renewcommand*{\arraystretch}{1.2}
\begin{tabular}{|c|c|c|}
\hline 
\textbf{Phasenrand $\varphi_R$} & \textbf{Streckenphase $\varphi_S$} & \textbf{Überschwingen} \\ 
\hline 
$45^\circ$ & $-135^\circ$ & $23\%$ \\ 
\hline 
$51.8^\circ$ & $-128.5^\circ$ & $16.3\%$ \\ 
\hline 
 $65.5^\circ$& $-114.6^\circ$ & $4.6\%$ \\ 
\hline 
$76.3^\circ$ & $-103.7^\circ$ & $0\%$ \\ 
\hline
\end{tabular} 
\caption{Zusammenhang Phasenrand und Überschwingen}
\label{phasenrand}
\renewcommand*{\arraystretch}{1}
\end{table}


Zur Berechnung der Verstärkung werden nun die Amplitudengänge der Strecke, sowie des Reglers benötigt. Dazu wird im Phasengang der offenen Regelung $\varphi_S$ der Phasenrand abgetragen. Dies liefert die Kreisfrequenz $\omega_D$. Die beiden Amplituden bei der Kreisfrequenz $\omega_D$, werden miteinander multipliziert. Gemäss Phasengangmethode soll die Verstärkung an dieser Stelle eins sein. Dies führt zur Formel \ref{formelkr}. $Go(\omega_D)$ entspricht dem Amplitudengang der offenen Regelung an der Stelle $\omega_D$. \newline
%Zellweger Skript
\begin{align}
K_R=\frac{1}{\vert{Go(\omega_D)}\vert{}}
\label{formelkr}
\end{align}

\newpage
\subsubsection{Ablauf der Phasengangmethode}
Die Phasengangmethode der Strecke $\varphi_S$ wird nach dem folgenden Ablauf durchgeführt. Die Punkte 2. und 3. werden nur für PID-Regler benötigt. Eine numerische Beispielrechnung für einen PI-Regler ist im Anhang angefügt.
\begin{enumerate}
\item Im Phasengang der Strecke $\varphi_S$ werden die Kreisfrequenzen in bestimmten Punkten gesucht.
\item Der Faktor $\beta$ wird bestimmt.
\item Mithilfe von $\beta$ werden die Zeiten $T_{nk}$ und $T_{vk}$ ermittelt.
\item Der Phasengang der offenen Regelung $\varphi_{go}$ wird berechnet (Phasengang Strecke + Phasengang Regler)
\item Die Kreisfrequenz $\omega_D$ beim gewählten Phasenrand wird berechnet.
\item Die Amplitudengänge der Strecke sowie des Reglers bei $\omega_D$ werden miteinander multipliziert. Damit wird die Reglerverstärkung $K_R$ festgelegt. 
\end{enumerate}

Besondere Vorsicht ist bei den erhaltenen Kenngrössen des dimensionierten Reglers geboten. Es wird zwischen Regler- und Bodekonform unterschieden. Bodekonform bedeutet, dass die Parameter kaskadiert sind und die logarithmische Rechnung somit vereinfacht wird. Standardmässig wird in der Fachliteratur meist reglerkonform gerechnet. Die Parameter des PI-Reglers sind reglerkonform und können somit direkt weiterverwendet werden. Die Parameter des PID-Reglers, welche wir bei der Dimensionierung mittels Phasengangmethode erhalten, sind bodekonform. Sie können jedoch in die reglerkonforme Darstellung umgerechnet werden. Für die Umrechnung wurden die Formeln \ref{krherl}, \ref{tnherl} und \ref{tvherl} für PID-Regler hergeleitet (siehe Anhang): \cite{zellwegerpha}\newline
%Zellweger Skript

\begin{align}
K_R=K_{rk}\left(1+\frac{T_{vk}}{T_{nk}}-\frac{T_p}{T_{nk}}\right)
\label{krherl}
\end{align}
\begin{align}
T_n=T_{nk}+T_{vk}-T_p
\label{tnherl}
\end{align}
\begin{align}
T_v=\frac{T_{nk}T_{vk}}{T_{nk}+T_{vk}-T_p}-T_p
\label{tvherl}
\end{align}\newline

Tp steht für die parasitäre Zeitkonstante. Diese wird benötigt, da ein idealer PID-Regler in der Praxis nicht umsetzbar ist. Der Index k in der bodekonformen Darstellung steht für Kaskadierung.

\subsection{Übertragungsfunktion der Regler}
Um schlussendlich die Schrittantwort der geschlossenen Regelung berechnen zu können, wird die Übertragungsfunktion des dimensionierten Reglers benötigt. Diese lässt sich mit den aus der Phasengangmethode erhaltenen Parametern aufstellen (Tabelle \ref{ufunkregler}).\newline
\begin{table}
\centering
\renewcommand*{\arraystretch}{1.7}
\begin{tabular}{|l|l|}
\hline 
\textbf{Beschreibung} & \textbf{Darstellung} \\ 
\hline
PI-Regler bodekonform & $G_R(s)=K_R\frac{(1+sT_n)}{sT_n}$ \\ 
\hline 
PI-Regler reglerkonform & $G_R(s)=K_R\left(1+\frac{1}{sT_n}\right)$ \\ 
\hline 
PID-Regler bodekonform & $G_R(s)=K_{rk}\frac{(1+sT_{nk})(1+sT_{vk})}{sT_{nk}(1+sT_p)}$ \\ 
\hline 
PID-Regler reglerkonform & $G_R(s)=K_R\left(1+\frac{1}{sT_n}+\frac{sT_v}{1+sT_p}\right)$ \\ 
\hline 
\end{tabular} 
\renewcommand*{\arraystretch}{1}
\caption{Übertragungsfunktionen Regler \cite{zellwegerregel}}
\label{ufunkregler}
\end{table}
% Zellweger Skript "Regelkreise und Regelungen"

\newpage
\subsection{Dimensionierung mit Faustformeln}
Die Dimensionierung mittels Faustformeln wird durchgeführt, um die Dimensionierungsresultate der Phasengangmethode am Schluss zu vergleichen und auszuwerten. Es gibt etliche verschiedene Faustformeln von unterschiedlichen Personen. Die bekanntesten und gängigsten Dimensionierungsformeln sind in den folgenden Tabellen aufgelistet und werden im Programm implementiert.\\

\begin{table}[h]
\centering
\renewcommand*{\arraystretch}{1.7}
\begin{tabular}{|l|l|c|c|c|}
\hline 
\textbf{Formeltyp} & \textbf{Regler} & \textbf{$K_R$} & \textbf{$T_n$} & \textbf{$T_v$} \\ 
\hline 
 & \textbf{P} & $\frac{T_g}{K_sT_u}$ &  &  \\ 
\cline{2-5} 
\textbf{Ziegler/Nichols}&\textbf{PI} & $\frac{0.9*T_g}{K_sT_u}$ & $3.3*T_u$ &  \\ 
\cline{2-5} 
&\textbf{PID} & $\frac{0.9*T_g}{K_sT_u}$ & $2*T_u$ & $0.42*T_t$ \\ 
\hline 

&\textbf{P} & $\frac{T_g}{K_sT_u}$ &  &  \\ 
\cline{2-5} 
\textbf{Oppelt} &\textbf{PI} & $\frac{0.8*T_g}{K_sT_u}$ & $3*T_u$ &  \\ 
\cline{2-5} 
&\textbf{PID} & $\frac{1.2*T_g}{K_sT_u}$ & $2*T_u$ & $0.42*T_t$ \\ 
\hline 

&\textbf{P} & $\frac{T_g}{K_sT_u}$ &  &  \\ 
\cline{2-5} 
\textbf{Rosenberg} &\textbf{PI} & $\frac{0.91*T_g}{K_sT_u}$ & $3.3*T_u$ &  \\ 
\cline{2-5}  
&\textbf{PID} & $\frac{1.2*T_g}{K_sT_u}$ & $2*T_u$ & $0.44*T_t$ \\ 
\hline 

\end{tabular} 
\renewcommand*{\arraystretch}{1}
\caption{Fausformeln Ziegler/Nichols, Oppelt und Rosenberg \cite{bate}}
\end{table}
% Boulent Bate Skript "Spezialgebiete der Steuer- und Regelungstechnik"

\begin{table}
\centering
\renewcommand*{\arraystretch}{1.5}
\begin{tabular}{|l|c|c|c|c|}
\hline 
& \multicolumn{2}{c|}{\textbf{aperiodischer}} & \multicolumn{2}{c|}{\textbf{Einschwingvorgang mit}} \\
\textbf{Reglertyp} & \multicolumn{2}{c|}{\textbf{Einschwingvorgang}} & \multicolumn{2}{c|}{\textbf{20\% Überschwingen}}\\
\cline{2-5} 
 & Führung & Störung & Führung & Störung \\ 
\hline 
\textbf{P} & $K_R=\frac{0.3*T_g}{K_sT_u}$ & $K_R=\frac{0.3*T_g}{K_sT_u}$ & $K_R=\frac{0.7*T_g}{K_sT_u}$ & $K_R=\frac{0.7*T_g}{K_sT_u}$ \\ 
\hline 
\multirow{2}{*}{\textbf{PI}} & $K_R=\frac{0.35*T_g}{K_sT_u}$ & $K_R=\frac{0.6*T_g}{K_sT_u}$ & $K_R=\frac{0.6*T_g}{K_sT_u}$ & $K_R=\frac{0.7*T_g}{K_sT_u}$ \\ 
& $T_n=1.2*T_g$ & $T_n=4*T_u$ & $T_n=T_g$ & $T_n=2.3*T_u$ \\ 
\hline 
 & $K_R=\frac{0.6*T_g}{K_sT_u}$ & $K_R=\frac{0.95*T_g}{K_sT_u}$ & $K_R=\frac{0.95*T_g}{K_sT_u}$ & $K_R=\frac{1.2*T_g}{K_sT_u}$\\ 
\textbf{PID} & $T_n=T_g$ & $T_n=2.4*T_u$ &  $T_n=1.35*T_g$ & $T_n=2.3*T_u$ \\ 
 & $T_v=0.5*T_u$ & $T_v=0.42*T_u$ & $T_v=0.47*T_u$ & $T_v=0.42*T_u$ \\ 
\hline 
\end{tabular}
\renewcommand*{\arraystretch}{1}
\caption{Chien/Hrones und Reswick \cite{bate}} 
\end{table}
% Skript bate


\newpage
\subsection{Schrittantwort der Regelung}
\subsubsection{Berechnung}
Um die Schrittantwort der geschlossenen Regelung berechnen zu können, wird die Übertragungsfunktion der Regelung benötigt. Diese wird aus den Übertragungsfunktionen des Reglers und der Strecke gemässe Formel \ref{ufunkregelung} berechnet.

\begin{align}
G(s)=\frac{G_R(s)G_S(s)}{1+G_R(s)G_S(s)}
\label{ufunkregelung}
\end{align}

Die Berechnung der Schrittantwort wird mittels Residuenrechnung durchgeführt. Erstes Teilziel ist es die Übertragungsfunktion in die Form von Formel \ref{residue1} zu bringen, wo $B(s)$ das Zählerpolynom der Übertragungsfunktion, $A(s)$ das Nennerpolynom, $R(n)$ die Residuen, $P(n)$ die Polstellen und $K$ den Direktterm darstellen.

\begin{align}
\frac{B(s)}{A(s)}=\frac{R(1)}{s-P(1)}+\frac{R(2)}{s-P(2)}+...+ K
\label{residue1}
\end{align}

Dafür werden als erstes die Polstellen der Übertragungsfunktion gesucht. Diese befinden sich bei den Nullstellen des Nennerpolynoms. Die Residuen erhält man durch die Partialbruchzerlegung mittels Residuenkalkül gemäss Formel \ref{residue2}, welche aber nur Gültigkeit hat, wenn ausschliesslich einfache Nullstellen vorkommen.

\begin{align}
R(n)=\lim_{s \to P(n)}(s-P(n))\frac{B(s)}{A(s)}
\label{residue2}
\end{align}

Durch die inverse Laplactransformation, unter Verwendung der Korrespondenztabellen erhält man die Impulsantwort $h(t)$ (Formel \ref{residue3} mit $t\geq0$ ).

\begin{align}
h(t)=K\delta(t)+\sum_{i=1}^n R(i)*e^{P(i)t}
\label{residue3}
\end{align}

Aus der erhaltenen Implusantwort $h(t)$ muss nun noch die Schrittantwort berechnet werden, was mittels Integration gemacht wird (Formel \ref{intimpantwort}).

\begin{align}
s(t)=\int_0^t K\delta(\tau) d\tau + \sum_{i=1}^n \int_0^t R(i)*e^{P(i)\tau} d\tau
\label{intimpantwort}
\end{align}

Die Schrittantwort wird zusätzlich noch analysiert. Folgende Werte werden ausgewertet:
\begin{itemize}
\item Anregelzeit $T_{an}$:   Die Zeit, welche die Strecke benätigt bis der Sollwert das erste mal erreicht wird.
\item Ausregelzeit $T_{aus}$:   Die Zeit, welche die Strecke benötigt bis die Strecke in einem gewissen Toleranzbereich einmündet, und diesen nicht wieder verlässt.
\item Max. Überschwingen $Y_{max}$:   Der Wert an der Stelle, wo die Schrittantwort an meisten vom Sollwert abweicht.
\end{itemize}


\subsubsection{Optimierungsmöglichkeiten}
Falls die berechnete und dargestellte Schrittantwort der Regelung nicht der Vorstellung und den Ansprüchen des Nutzers entspricht, soll dieser die Möglichkeiten haben, die Schrittantwort nach seinen Anforderungen zu optimieren. Dazu gibt es verschiedene Möglichkeiten. 

Einerseits kann der Regler durch seine Eigenschaften $K_R$, $T_n$ und $T_v$ modifiziert werden. Eine Schrittantwort durch die Veränderung dieser drei Eigenschaften zu optimieren ist äusserst schwierig. Dies erfordert grosses Wissen und viel Erfahrung in der Regelungstechnik, was einem weniger erfahrenen Nutzer die Optimierung nahezu verunmöglicht.

Es besteht jedoch die Möglichkeit die Optimierungen durch Verändern gewisser Parameter in der Phasengangmethode durchzuführen. So ist es aus der Theorie ersichtlich, dass der gewählte Phasenrand auf das Überschwingen Einfluss hat (siehe Kapitel \ref{phasenganggrundlagen}, S. \pageref{phasenrand}, Tabelle \ref{phasenrand}). Die Berechnung kann also mittels gewähltem Phasenrand solange optimiert werden, bis das Überschwingen der Schrittantwort den Anforderungen entspricht.
